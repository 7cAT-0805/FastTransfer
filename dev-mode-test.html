<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FastTransfer é–‹ç™¼è€…æ¨¡å¼æ¸¬è©¦</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
        }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .warning { background-color: #fff3cd; border-color: #ffeaa7; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        pre { 
            background: #f8f9fa; 
            padding: 10px; 
            border-radius: 3px; 
            overflow-x: auto;
        }
        .console-output {
            background: #212529;
            color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ› ï¸ FastTransfer é–‹ç™¼è€…æ¨¡å¼æ¸¬è©¦</h1>
        
        <div class="test-section info">
            <h3>ğŸ“‹ æ¸¬è©¦èªªæ˜</h3>
            <p>é€™å€‹é é¢ç”¨æ–¼æ¸¬è©¦ FastTransfer çš„é–‹ç™¼è€…æ¨¡å¼åŠŸèƒ½ã€‚è«‹æŒ‰ç…§ä»¥ä¸‹æ­¥é©Ÿé€²è¡Œæ¸¬è©¦ï¼š</p>
        </div>

        <div class="test-section">
            <h3>1ï¸âƒ£ é–‹ç™¼è€…æ¨¡å¼å•Ÿç”¨æ¸¬è©¦</h3>
            <p><strong>æ“ä½œï¼š</strong>æŒ‰ F12 æ‰“é–‹é–‹ç™¼è€…å·¥å…·ï¼Œåœ¨æ§åˆ¶å°è¼¸å…¥ <code>DevMode_7cAT()</code></p>
            <button onclick="checkDevMode()">æª¢æŸ¥é–‹ç™¼è€…æ¨¡å¼ç‹€æ…‹</button>
            <div id="devModeStatus"></div>
        </div>

        <div class="test-section">
            <h3>2ï¸âƒ£ æ¨¡æ“¬ API æ¸¬è©¦</h3>
            <button onclick="testMockAPI()">æ¸¬è©¦æ¨¡æ“¬ API</button>
            <div id="apiTestResult"></div>
        </div>

        <div class="test-section">
            <h3>3ï¸âƒ£ æ¨¡æ“¬ Socket æ¸¬è©¦</h3>
            <button onclick="testMockSocket()">æ¸¬è©¦æ¨¡æ“¬ Socket</button>
            <div id="socketTestResult"></div>
        </div>

        <div class="test-section">
            <h3>4ï¸âƒ£ æ–‡ä»¶åœ–æ¨™æ¸¬è©¦</h3>
            <button onclick="testFileIcons()">æ¸¬è©¦æ–‡ä»¶åœ–æ¨™</button>
            <div id="fileIconResult"></div>
        </div>

        <div class="test-section">
            <h3>5ï¸âƒ£ æ§åˆ¶å°æ—¥èªŒæ¸¬è©¦</h3>
            <button onclick="testConsoleLog()">æ¸¬è©¦æ§åˆ¶å°æ—¥èªŒ</button>
            <div id="consoleLogResult"></div>
        </div>

        <div class="test-section warning">
            <h3>âš ï¸ æ³¨æ„äº‹é …</h3>
            <ul>
                <li>é–‹ç™¼è€…æ¨¡å¼åªèƒ½é€šé F12 æ§åˆ¶å°è¼¸å…¥ <code>DevMode_7cAT()</code> å•Ÿç”¨</li>
                <li>å•Ÿç”¨å¾Œæœƒåœ¨é é¢å³ä¸‹è§’é¡¯ç¤ºé–‹ç™¼è€…é¢æ¿</li>
                <li>æ‰€æœ‰ API è«‹æ±‚å°‡ä½¿ç”¨æ¨¡æ“¬æ•¸æ“š</li>
                <li>æ§åˆ¶å°æ—¥èªŒåªåœ¨é–‹ç™¼è€…æ¨¡å¼ä¸‹é¡¯ç¤º</li>
                <li>é–‹ç™¼è€…æ¨¡å¼ç‹€æ…‹æœƒä¿å­˜åœ¨ localStorage ä¸­</li>
            </ul>
        </div>

        <div class="console-output" id="consoleOutput">
            æ§åˆ¶å°è¼¸å‡ºå°‡é¡¯ç¤ºåœ¨é€™è£¡...
        </div>
    </div>

    <script>
        // æ¨¡æ“¬é–‹ç™¼è€…æ¨¡å¼é¡
        class MockDeveloperMode {
            static instance = null;
            enabled = false;

            static getInstance() {
                if (!this.instance) {
                    this.instance = new MockDeveloperMode();
                }
                return this.instance;
            }

            isEnabled() {
                return this.enabled || localStorage.getItem('fastransfer_dev_mode') === 'true';
            }

            enable() {
                this.enabled = true;
                localStorage.setItem('fastransfer_dev_mode', 'true');
                console.log('ğŸš€ Developer Mode Activated!');
            }

            getMockFiles() {
                return [
                    { name: 'test.txt', mimetype: 'text/plain' },
                    { name: 'image.jpg', mimetype: 'image/jpeg' },
                    { name: 'document.pdf', mimetype: 'application/pdf' },
                    { name: 'archive.zip', mimetype: 'application/zip' },
                    { name: 'unknown', mimetype: undefined }
                ];
            }
        }

        // æ¨¡æ“¬æ–‡ä»¶åœ–æ¨™å‡½æ•¸
        function getFileIcon(mimetype) {
            if (!mimetype) return 'ğŸ“';
            if (mimetype.startsWith('image/')) return 'ğŸ–¼ï¸';
            if (mimetype.startsWith('video/')) return 'ğŸ¥';
            if (mimetype.startsWith('audio/')) return 'ğŸµ';
            if (mimetype.includes('pdf')) return 'ğŸ“„';
            if (mimetype.includes('zip') || mimetype.includes('rar')) return 'ğŸ“¦';
            if (mimetype.includes('text')) return 'ğŸ“';
            return 'ğŸ“';
        }

        const devMode = MockDeveloperMode.getInstance();
        let consoleOutput = document.getElementById('consoleOutput');

        // é‡å¯« console.log ä¾†é¡¯ç¤ºè¼¸å‡º
        const originalConsoleLog = console.log;
        console.log = function(...args) {
            originalConsoleLog.apply(console, args);
            if (devMode.isEnabled()) {
                consoleOutput.innerHTML += `<div>ğŸ”§ ${args.join(' ')}</div>`;
                consoleOutput.scrollTop = consoleOutput.scrollHeight;
            }
        };

        // æ·»åŠ å…¨åŸŸé–‹ç™¼è€…æ¨¡å¼å•Ÿç”¨å‡½æ•¸
        window.DevMode_7cAT = () => {
            console.log('ğŸ› ï¸ Activating Developer Mode...');
            devMode.enable();
            checkDevMode();
        };

        function checkDevMode() {
            const status = document.getElementById('devModeStatus');
            const isEnabled = devMode.isEnabled();
            
            if (isEnabled) {
                status.innerHTML = `
                    <div class="success" style="padding: 10px; margin-top: 10px; border-radius: 5px;">
                        âœ… é–‹ç™¼è€…æ¨¡å¼å·²å•Ÿç”¨
                        <br>localStorage ç‹€æ…‹: ${localStorage.getItem('fastransfer_dev_mode')}
                    </div>`;
            } else {
                status.innerHTML = `
                    <div class="warning" style="padding: 10px; margin-top: 10px; border-radius: 5px;">
                        âš ï¸ é–‹ç™¼è€…æ¨¡å¼æœªå•Ÿç”¨
                        <br>è«‹åœ¨æ§åˆ¶å°è¼¸å…¥ DevMode_7cAT() ä¾†å•Ÿç”¨
                    </div>`;
            }
        }

        function testMockAPI() {
            const result = document.getElementById('apiTestResult');
            
            if (!devMode.isEnabled()) {
                result.innerHTML = `<div class="warning" style="padding: 10px; margin-top: 10px; border-radius: 5px;">è«‹å…ˆå•Ÿç”¨é–‹ç™¼è€…æ¨¡å¼</div>`;
                return;
            }

            console.log('ğŸ› ï¸ Dev Mode API Call: POST /rooms');
            console.log('ğŸ› ï¸ Dev Mode API Call: GET /files');
            
            result.innerHTML = `
                <div class="success" style="padding: 10px; margin-top: 10px; border-radius: 5px;">
                    âœ… æ¨¡æ“¬ API æ¸¬è©¦å®Œæˆ
                    <br>â€¢ æ¨¡æ“¬æˆ¿é–“å‰µå»º API
                    <br>â€¢ æ¨¡æ“¬æ–‡ä»¶ç²å– API
                    <br>â€¢ æª¢æŸ¥æ§åˆ¶å°è¼¸å‡º
                </div>`;
        }

        function testMockSocket() {
            const result = document.getElementById('socketTestResult');
            
            if (!devMode.isEnabled()) {
                result.innerHTML = `<div class="warning" style="padding: 10px; margin-top: 10px; border-radius: 5px;">è«‹å…ˆå•Ÿç”¨é–‹ç™¼è€…æ¨¡å¼</div>`;
                return;
            }

            console.log('ğŸ”Œ Mock Socket Emit: joinRoom');
            console.log('ğŸ› ï¸ Developer Mode: Using mock socket');
            console.log('ğŸ› ï¸ Developer Mode: Simulating room join: TEST123');
            
            result.innerHTML = `
                <div class="success" style="padding: 10px; margin-top: 10px; border-radius: 5px;">
                    âœ… æ¨¡æ“¬ Socket æ¸¬è©¦å®Œæˆ
                    <br>â€¢ æ¨¡æ“¬ Socket é€£æ¥
                    <br>â€¢ æ¨¡æ“¬æˆ¿é–“åŠ å…¥
                    <br>â€¢ æª¢æŸ¥æ§åˆ¶å°è¼¸å‡º
                </div>`;
        }

        function testFileIcons() {
            const result = document.getElementById('fileIconResult');
            const mockFiles = devMode.getMockFiles();
            
            let output = '<div style="padding: 10px; margin-top: 10px; border-radius: 5px; background: #f8f9fa;">';
            output += '<h4>æ–‡ä»¶åœ–æ¨™æ¸¬è©¦çµæœï¼š</h4>';
            
            mockFiles.forEach(file => {
                const icon = getFileIcon(file.mimetype);
                output += `<div>${icon} ${file.name} (${file.mimetype || 'undefined'})</div>`;
                console.log(`ğŸ“ File icon test: ${file.name} -> ${icon}`);
            });
            
            output += '</div>';
            result.innerHTML = output;
        }

        function testConsoleLog() {
            const result = document.getElementById('consoleLogResult');
            
            // æ¸¬è©¦å„ç¨®é¡å‹çš„æ—¥èªŒ
            console.log('ğŸ”§ API Configuration test log');
            console.log('âœ… Socketé€£æ¥æ¸¬è©¦');
            console.log('ğŸšª å˜—è©¦åŠ å…¥æˆ¿é–“æ¸¬è©¦');
            console.log('ğŸ› ï¸ é–‹ç™¼è€…æ¨¡å¼æ¸¬è©¦æ—¥èªŒ');
            
            if (devMode.isEnabled()) {
                result.innerHTML = `
                    <div class="success" style="padding: 10px; margin-top: 10px; border-radius: 5px;">
                        âœ… æ§åˆ¶å°æ—¥èªŒæ¸¬è©¦å®Œæˆ
                        <br>â€¢ é–‹ç™¼è€…æ¨¡å¼ï¼šé¡¯ç¤ºæ‰€æœ‰æ—¥èªŒ
                        <br>â€¢ æª¢æŸ¥æ§åˆ¶å°å’Œä¸‹æ–¹è¼¸å‡ºå€åŸŸ
                    </div>`;
            } else {
                result.innerHTML = `
                    <div class="info" style="padding: 10px; margin-top: 10px; border-radius: 5px;">
                        â„¹ï¸ éé–‹ç™¼è€…æ¨¡å¼ï¼šæ—¥èªŒè¢«éš±è—
                        <br>â€¢ ç”Ÿç”¢ç’°å¢ƒä¸æœƒé¡¯ç¤ºé™¤éŒ¯æ—¥èªŒ
                        <br>â€¢ è«‹å•Ÿç”¨é–‹ç™¼è€…æ¨¡å¼æŸ¥çœ‹å®Œæ•´æ—¥èªŒ
                    </div>`;
            }
        }

        // æ¸…é™¤æŒ‰éˆ•
        function clearConsole() {
            consoleOutput.innerHTML = 'æ§åˆ¶å°è¼¸å‡ºå°‡é¡¯ç¤ºåœ¨é€™è£¡...';
        }

        function resetDevMode() {
            localStorage.removeItem('fastransfer_dev_mode');
            devMode.enabled = false;
            checkDevMode();
            clearConsole();
        }

        // åˆå§‹åŒ–
        checkDevMode();
    </script>

    <div style="text-align: center; margin-top: 20px;">
        <button onclick="clearConsole()">æ¸…é™¤æ§åˆ¶å°è¼¸å‡º</button>
        <button onclick="resetDevMode()" style="background: #dc3545;">é‡ç½®é–‹ç™¼è€…æ¨¡å¼</button>
    </div>
</body>
</html>
